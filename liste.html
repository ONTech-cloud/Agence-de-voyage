<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Liste des Réservations</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #eef6ff;
      margin: 20px;
      color: #222;
    }
    h1 {
      text-align: center;
      color: #3759e6;
      margin-bottom: 20px;
    }
    .reservation {
      background: white;
      border-radius: 8px;
      box-shadow: 0 0 8px rgba(0,0,0,0.1);
      padding: 20px;
      margin-bottom: 20px;
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
    }
    .vol-info, .passager-info {
      margin-bottom: 10px;
    }
    .vol-info strong, .passager-info strong {
      color: #3759e6;
    }
    .passager-info {
      border-top: 1px solid #ddd;
      padding-top: 10px;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>Liste des Réservations</h1>
  <div id="listeReservations">Chargement des réservations...</div>

  <script type="module">
    import { db } from './firebase-config.js';
    import { collection, getDocs } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-firestore.js";

    const listeDiv = document.getElementById('listeReservations');

    async function afficherReservations() {
      const querySnapshot = await getDocs(collection(db, "reservations"));
      if (querySnapshot.empty) {
        listeDiv.innerHTML = "<p>Aucune réservation trouvée.</p>";
        return;
      }

      listeDiv.innerHTML = "";
      querySnapshot.forEach(doc => {
        const data = doc.data();

        const divReservation = document.createElement('div');
        divReservation.className = "reservation";

        divReservation.innerHTML = `
          <div class="vol-info">
            <strong>Vol de ${data.depart} à ${data.arrivee}</strong><br/>
            Date départ: ${data.date_depart} &nbsp;&nbsp; Jour arrivée: ${data.jour_arrivee}<br/>
            Heure départ: ${data.heure_depart} &nbsp;&nbsp; Heure arrivée: ${data.heure_arrivee}<br/>
            Numéro vol: ${data.num_vol} &nbsp;&nbsp; Compagnie: ${data.compagnie}<br/>
            Classe: ${data.classe} &nbsp;&nbsp; Terminal: ${data.terminal} &nbsp;&nbsp; Porte: ${data.porte}
          </div>
          <div>
            <strong>Passagers:</strong>
          </div>
        `;

        data.passagers.forEach((p, i) => {
          const divPassager = document.createElement('div');
          divPassager.className = "passager-info";
          divPassager.innerHTML = `
            <em>Passager ${i+1}:</em><br/>
            Nom: ${p.nom}<br/>
            Âge: ${p.age}<br/>
            Téléphone: ${p.tel}<br/>
            Email: ${p.email}<br/>
            Numéro billet: ${p.billet}
          `;
          divReservation.appendChild(divPassager);
        });

        listeDiv.appendChild(divReservation);
      });
    }

    afficherReservations();
  </script>
</body>
</html>
